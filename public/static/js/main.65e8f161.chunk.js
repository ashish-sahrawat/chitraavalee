(this.webpackJsonpchitraavalee=this.webpackJsonpchitraavalee||[]).push([[0],{27:function(e,t,n){},28:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(20),c=n.n(s),o=(n(27),n(2)),i=(n(28),n.p+"static/media/chitravaleelogo.71ac4293.png"),l=new Map,u=[],d={CURRENT_USER:"currentUser",TOKEN:"token",SUCCESS_ALERT:"successAlert",DANGER_ALERT:"dangerAlert"};function m(e,t){l.set(e,t)}function j(e){return l.delete(e)}function b(e){u=u.filter((function(t){return t.eventName!==e}))}var p={saveOrUpdateState:m,getState:function(e){return l.get(e)},registerHandler:function(e,t){b(e),u.push({eventName:e,callback:t})},fireEvent:function(e,t){u.forEach((function(n){n.eventName===e&&n.callback(t)}))},events:d,removeState:j,updateCurrentUser:function(e){localStorage.removeItem(d.CURRENT_USER),j(d.CURRENT_USER),m(d.CURRENT_USER,e),localStorage.setItem(d.CURRENT_USER,JSON.stringify(e))},removeHandler:b},f=n(4),v=n(10),h=n(0);var O=function(e){var t=e.searchUserHandler,n=Object(a.useState)(null),r=Object(o.a)(n,2),s=r[0],c=r[1],l=Object(a.useState)(""),u=Object(o.a)(l,2),d=u[0],m=u[1],j=Object(f.e)();return Object(a.useEffect)((function(){return p.registerHandler("home",(function(e){var t=localStorage.getItem(p.events.TOKEN),n=localStorage.getItem(p.events.CURRENT_USER);t&&n&&(p.saveOrUpdateState(p.events.CURRENT_USER,JSON.parse(n)),p.saveOrUpdateState(p.events.TOKEN,t),c(n))})),function(){p.removeHandler("home")}}),[]),Object(a.useEffect)((function(){var e=localStorage.getItem(p.events.TOKEN),t=localStorage.getItem(p.events.CURRENT_USER);e&&t&&(p.saveOrUpdateState(p.events.CURRENT_USER,JSON.parse(t)),p.saveOrUpdateState(p.events.TOKEN,e),c(t))}),[]),Object(a.useEffect)((function(){localStorage.getItem(p.events.TOKEN)||j.push("/login")}),[j]),Object(h.jsxs)("nav",{className:"navbar navbar-expand-sm  navbar-light header",children:[Object(h.jsx)("a",{className:"navbar-brand ms-auto",href:"/",children:Object(h.jsx)("img",{src:i,alt:"logo",className:"logo-img"})}),Object(h.jsx)("ul",{className:"navbar-nav mx-auto",children:null!=s&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(v.b,{className:"nav-link",to:"/",children:"World"})}),Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(v.b,{className:"nav-link",to:"/albums",children:"My Albums"})}),Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(v.b,{className:"nav-link",to:"/upload",children:"Upload"})})]})}),Object(h.jsxs)("ul",{className:"navbar-nav me-auto",children:[null!=s&&Object(h.jsx)("li",{className:"nav-item spacingForm",children:Object(h.jsxs)("form",{className:"form-inline",children:[Object(h.jsx)("input",{className:"form-control",type:"text",placeholder:"Search Users",value:d,onChange:function(e){m(e.target.value)}}),Object(h.jsx)("button",{className:"btn btn-dark",type:"submit",onClick:function(e){e.preventDefault(),t(d)},children:"Search"})]})}),Object(h.jsx)("li",{className:"nav-item",children:null==s?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(v.b,{to:"/login",className:"btn btn-dark spacingButton",children:"Login"}),Object(h.jsx)(v.b,{to:"/signup",className:"btn btn-dark",children:"SignUp"})]}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(v.b,{to:"/profile",className:"btn btn-dark spacingButton",children:"Profile"}),Object(h.jsx)("button",{className:"btn btn-dark",onClick:function(e){localStorage.removeItem(p.events.TOKEN),localStorage.removeItem(p.events.CURRENT_USER),p.removeState(p.events.TOKEN),p.removeState(p.events.CURRENT_USER),c(null),j.push("/login")},children:"Logout"})]})})]})]})},g=(n(35),n(22));n(36);var N=function(e){var t=e.commenterName,n=e.message,a=e.commentDate,r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"];return Object(h.jsxs)("div",{className:"comment",children:[Object(h.jsxs)("div",{className:"commentText",children:[Object(h.jsx)("b",{children:t})," ",n]}),Object(h.jsx)("div",{className:"commentDate",children:function(){var e=new Date(a);return e.getDate()+"/"+r[e.getMonth()]+"/"+e.getFullYear()+" "+e.getHours()+":"+e.getMinutes()}()})]})},x=(n(37),n(3)),E=n.n(x),S=n(6);function R(){return(R=Object(S.a)(E.a.mark((function e(t,n){var a,r,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=C(),a+="/api/login",r={email:t,password:n},e.next=5,fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 5:return s=e.sent,e.abrupt("return",s.json());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){return(U=Object(S.a)(E.a.mark((function e(t,n,a){var r,s,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=C(),r+="/api/register",s={email:t,password:a,name:n},e.next=5,fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});case 5:return c=e.sent,e.abrupt("return",c.json());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){return(T=Object(S.a)(E.a.mark((function e(t,n,a){var r,s,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=C(),r+="/api/album",s={albumName:t,isPrivate:n},e.next=5,fetch(r,{method:"POST",headers:{"Content-Type":"application/json",token:"Bearer "+a},body:JSON.stringify(s)});case 5:return c=e.sent,e.abrupt("return",c.json());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return(A=Object(S.a)(E.a.mark((function e(t){var n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=C(),n+="/api/albums",e.next=4,fetch(n,{method:"GET",headers:{"Content-Type":"application/json",token:"Bearer "+t}});case 4:return a=e.sent,e.abrupt("return",a.json());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=Object(S.a)(E.a.mark((function e(t,n){var a,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=C(),a+="/api/posts/"+t,e.next=4,fetch(a,{method:"GET",headers:{"Content-Type":"application/json",token:"Bearer "+n}});case 4:return r=e.sent,e.abrupt("return",r.json());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){var e="";return e}function w(){return(w=Object(S.a)(E.a.mark((function e(t,n,a,r){var s,c,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=C(),s+="/api/album/"+t,c={albumName:n,isPrivate:a},e.next=5,fetch(s,{method:"PUT",headers:{"Content-Type":"application/json",token:"Bearer "+r},body:JSON.stringify(c)});case 5:return o=e.sent,e.abrupt("return",o.json());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=Object(S.a)(E.a.mark((function e(t,n,a){var r,s,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=C(),r+="/api/post/comment",s={postId:t,comment:n},e.next=5,fetch(r,{method:"POST",headers:{"Content-Type":"application/json",token:"Bearer "+a},body:JSON.stringify(s)});case 5:return c=e.sent,e.abrupt("return",c.json());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return(L=Object(S.a)(E.a.mark((function e(t,n){var a,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=C(),a+="/api/users?search="+t,e.next=4,fetch(a,{method:"GET",headers:{"Content-Type":"application/json",token:"Bearer "+n}});case 4:return r=e.sent,e.abrupt("return",r.json());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return(_=Object(S.a)(E.a.mark((function e(t,n){var a,r,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=C(),a+="/api/users/follow",r={emailToFollow:t},e.next=5,fetch(a,{method:"POST",headers:{"Content-Type":"application/json",token:"Bearer "+n},body:JSON.stringify(r)});case 5:return s=e.sent,e.abrupt("return",s.json());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(S.a)(E.a.mark((function e(t,n){var a,r,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=C(),a+="/api/users/unfollow",r={emailToUnFollow:t},e.next=5,fetch(a,{method:"POST",headers:{"Content-Type":"application/json",token:"Bearer "+n},body:JSON.stringify(r)});case 5:return s=e.sent,e.abrupt("return",s.json());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return(F=Object(S.a)(E.a.mark((function e(t){var n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=C(),n+="/api/worldPosts",e.next=4,fetch(n,{method:"GET",headers:{"Content-Type":"application/json",token:"Bearer "+t}});case 4:return a=e.sent,e.abrupt("return",a.json());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=Object(S.a)(E.a.mark((function e(t,n){var a,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=C(),a+="/api/user/"+t,e.next=4,fetch(a,{method:"GET",headers:{"Content-Type":"application/json",token:"Bearer "+n}});case 4:return r=e.sent,e.abrupt("return",r.json());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I={doLogin:function(e,t){return R.apply(this,arguments)},doRegister:function(e,t,n){return U.apply(this,arguments)},addAlbum:function(e,t,n){return T.apply(this,arguments)},getAlbumsForCurrentUser:function(e){return A.apply(this,arguments)},updateAlbum:function(e,t,n,a){return w.apply(this,arguments)},getOriginURL:C,getPostsForAlbumId:function(e,t){return y.apply(this,arguments)},addCommentToPost:function(e,t,n){return k.apply(this,arguments)},getSearchedUsers:function(e,t){return L.apply(this,arguments)},followUser:function(e,t){return _.apply(this,arguments)},unfollowUser:function(e,t){return D.apply(this,arguments)},getWorldPosts:function(e){return F.apply(this,arguments)},getUserDetails:function(e,t){return P.apply(this,arguments)}};var G=function(e){var t=e.postId,n=e.postComments,r=Object(a.useState)(n),s=Object(o.a)(r,2),c=s[0],i=s[1],l=Object(a.useState)(""),u=Object(o.a)(l,2),d=u[0],m=u[1];return Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{className:"commentList",children:0===c.length?Object(h.jsx)(h.Fragment,{children:"No Comments yet"}):c.map((function(e,t){return Object(h.jsx)(N,{commenterName:e.commenterName,message:e.message,commentDate:e.commentDate},t)}))}),Object(h.jsxs)("form",{className:"form",children:[Object(h.jsx)("input",{type:"text",className:"form-control newCommentInput",placeholder:"Add a comment...",value:d,onChange:function(e){m(e.target.value)}}),Object(h.jsx)("button",{className:"btn btn-light newCommentButton",type:"submit",onClick:function(e){e.preventDefault();var n=p.getState(p.events.TOKEN);I.addCommentToPost(t,d,n).then((function(e){}));var a,r=p.getState(p.events.CURRENT_USER);a=[{commenterName:r.userName,commenterEmail:r.userEmail,message:d,commentDate:new Date}].concat(Object(g.a)(c)),i(a),m("")},children:"Post"})]})]})};n(39);var K=function(e){var t=e.userName,n=e.imageUrl,r=e.caption,s=e.timestamp,c=e.album,i=e.openAlbum,l=e.comments,u=e.postId,d=e.userEmail,m=Object(a.useState)(null),j=Object(o.a)(m,2),b=j[0],f=j[1],v=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"];return Object(a.useEffect)((function(){var e=p.getState(p.events.TOKEN);d&&I.getUserDetails(d,e).then((function(e){if(0===e.code){var t=e.response;t.photo&&f(I.getOriginURL()+"/userimage/"+t.photo)}else p.fireEvent(p.events.DANGER_ALERT,"Unable to get user details")}),[d])})),Object(h.jsxs)("div",{className:"card text-center shadow rounded post",children:[Object(h.jsxs)("div",{className:"card-header",children:[Object(h.jsx)("img",{src:null==b||""===b||void 0===b?"/images/img_avatar.png":b,className:"img-fluid avatar",alt:"post pic"}),Object(h.jsxs)("div",{className:"posthead-left-text",children:[Object(h.jsx)("p",{style:{fontWeight:"bold"},children:t}),Object(h.jsx)("p",{style:{fontSize:"small"},children:function(){var e=new Date(s);return e.getDate()+"/"+v[e.getMonth()]+"/"+e.getFullYear()+" "+e.getHours()+":"+e.getMinutes()}()})]}),Object(h.jsx)("div",{className:"posthead-right-text",children:Object(h.jsx)("p",{onClick:function(e){i(c)},style:{fontStyle:"italic",cursor:"pointer",textDecoration:"underline"},children:c&&c.albumName})})]}),Object(h.jsxs)("div",{className:"card-body",children:[Object(h.jsx)("img",{src:n,className:"card-img-top img-fluid",alt:"post pic"}),Object(h.jsxs)("p",{className:"card-text",children:[Object(h.jsxs)("b",{children:[t,": "]}),r]})]}),Object(h.jsx)("div",{className:"card-footer myfooter",children:Object(h.jsx)(G,{postId:u,postComments:l})})]})};n(40);var J=function(){var e=Object(a.useState)(""),t=Object(o.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(null),c=Object(o.a)(s,2),i=c[0],l=c[1],u=Object(a.useState)(0),d=Object(o.a)(u,2),m=d[0],j=d[1],b=Object(a.useState)([]),f=Object(o.a)(b,2),v=f[0],O=f[1],g=Object(a.useState)(""),N=Object(o.a)(g,2),x=N[0],E=N[1];function S(e){var t=e.loaded/e.total*100;j(t)}function R(e){p.fireEvent(p.events.SUCCESS_ALERT,"New Post created."),r(""),l(null),setTimeout((function(){j(0)}),1e3),E(v[0].id)}function U(e){p.fireEvent(p.events.DANGER_ALERT,"Failed creating Post."),console.log(e)}function T(e){p.fireEvent(p.events.DANGER_ALERT,"Failed creating Post."),console.log(e)}return Object(a.useEffect)((function(){var e=p.getState(p.events.TOKEN);I.getAlbumsForCurrentUser(e).then((function(e){if(0===e.code){var t=e.response;O(t.map((function(e){return{id:e._id,albumName:e.name,isPrivate:e.isPrivate,userEmail:e.userEmail}}))),t.length>0&&E(t[0]._id)}else p.fireEvent(p.events.DANGER_ALERT,"Failed to fetch User Albums.")}))}),[]),Object(h.jsx)(h.Fragment,{children:0===v.length?Object(h.jsx)("div",{className:"container image-upload",children:"Create Album first"}):Object(h.jsxs)("div",{className:"container image-upload",children:[Object(h.jsx)("h3",{children:Object(h.jsx)("i",{children:"Add Post to Album..."})}),Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("select",{className:"form-control",value:x,onChange:function(e){E(e.target.value)},children:v.map((function(e){return Object(h.jsx)("option",{value:e.id,children:e.albumName},e.id)}))})}),Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter caption",value:n,onChange:function(e){r(e.target.value)}})}),Object(h.jsx)("div",{className:"progress form-group",children:Object(h.jsx)("div",{className:"progress-bar",style:{width:m+"%"}})}),Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("input",{type:"file",className:"form-control-file border",accept:"image/*",onChange:function(e){e.target.files[0]&&l(e.target.files[0])}})}),Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("button",{className:"btn btn-success",onClick:function(e){!function(){var e=p.getState(p.events.TOKEN),t=I.getOriginURL();t+="/api/post";var a=new FormData;a.append("postImage",i),a.append("caption",n),a.append("albumId",x);var r=new XMLHttpRequest;r.upload.addEventListener("progress",S,!1),r.addEventListener("load",R,!1),r.addEventListener("error",U,!1),r.addEventListener("abort",T,!1),r.open("POST",t),r.setRequestHeader("token","Bearer ".concat(e)),r.send(a)}()},children:"Upload"})})]})})};n(41);var B=function(e){var t=e.handler,n=Object(a.useState)(""),r=Object(o.a)(n,2),s=r[0],c=r[1],i=Object(a.useState)(!1),l=Object(o.a)(i,2),u=l[0],d=l[1];return Object(h.jsxs)("div",{children:[Object(h.jsx)("h4",{children:"Add Album..."}),Object(h.jsxs)("form",{className:"form-inline",children:[Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter Album Name",value:s,onChange:function(e){c(e.target.value)}})}),Object(h.jsxs)("div",{className:"form-check spaceLeft",children:[Object(h.jsx)("input",{type:"checkbox",className:"form-check-input",id:"check1",checked:u,onChange:function(e){d(e.target.checked)}}),"Private"]}),Object(h.jsx)("div",{className:"form-group spaceLeft",children:Object(h.jsx)("button",{className:"btn btn-success",onClick:function(e){e.preventDefault();var n=p.getState(p.events.TOKEN);I.addAlbum(s,u,n).then((function(e){0===e.code?t():console.log(e.response)}))},children:"Add"})})]})]})};n(42);var M=function(e){var t=e.album,n=e.albumClickedHandler;return Object(h.jsxs)("div",{className:"col-lg-2 col-sm-6 album",onClick:function(e){n(t)},children:[Object(h.jsx)("div",{children:t.albumName}),!0===t.isPrivate?Object(h.jsxs)("div",{className:"indicator",children:[Object(h.jsx)("div",{className:"redDot"}),Object(h.jsx)("div",{className:"indicatorText",children:"Private"})]}):Object(h.jsxs)("div",{className:"indicator",children:[Object(h.jsx)("div",{className:"greenDot"}),Object(h.jsx)("div",{className:"indicatorText",children:"Public"})]})]})};n(43),n(44);var H=function(e){var t=e.handler,n=e.selectedAlbum,r=Object(a.useState)(n.albumName),s=Object(o.a)(r,2),c=s[0],i=s[1],l=Object(a.useState)(n.isPrivate),u=Object(o.a)(l,2),d=u[0],m=u[1];return Object(h.jsxs)("div",{children:[Object(h.jsx)("h4",{children:"Edit Album..."}),Object(h.jsxs)("form",{className:"form-inline",onSubmit:"updateAlbum()",children:[Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter Album Name",value:c,onChange:function(e){i(e.target.value)}})}),Object(h.jsxs)("div",{className:"form-check spaceLeft",children:[Object(h.jsx)("input",{type:"checkbox",className:"form-check-input",id:"check1",checked:d,onChange:function(e){m(e.target.checked)}}),"Private"]}),Object(h.jsx)("div",{className:"form-group spaceLeft",children:Object(h.jsx)("button",{type:"submit",className:"btn btn-success",onClick:function(e){e.preventDefault();var a=p.getState(p.events.TOKEN);I.updateAlbum(n.id,c,d,a).then((function(e){0===e.code?t():p.fireEvent(p.events.DANGER_ALERT,"Unable to update album")}))},children:"Edit"})}),Object(h.jsx)("div",{className:"form-group spaceLeft",children:Object(h.jsx)("button",{className:"btn btn-info",onClick:function(e){t()},children:"Back"})})]})]})};var q=function(e){var t=e.selectedAlbum,n=Object(a.useState)([]),r=Object(o.a)(n,2),s=r[0],c=r[1];return Object(a.useEffect)((function(){if(console.log(t),t){var e=p.getState(p.events.TOKEN);I.getPostsForAlbumId(t.albumId,e).then((function(e){if(0===e.code){var t=e.response;c(t.map((function(e){return{album:e.album,dateAdded:e.dateAdded,postId:e._id,comments:e.comments,caption:e.caption,imageUrl:I.getOriginURL()+"/postimage/"+e.fileName,userEmail:e.userEmail,userName:e.userName}})))}else p.fireEvent(p.events.DANGER_ALERT,"Unable to create user.")}))}}),[t]),Object(h.jsx)("div",{children:s.map((function(e){return Object(h.jsx)(K,{postId:e.postId,userName:e.userName,imageUrl:e.imageUrl,caption:e.caption,timestamp:e.dateAdded,comments:e.comments,userEmail:e.userEmail},e.postId)}))})};var W=function(){var e=Object(a.useState)([]),t=Object(o.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(0),c=Object(o.a)(s,2),i=c[0],l=c[1],u=Object(a.useState)(null),d=Object(o.a)(u,2),m=d[0],j=d[1],b=p.getState(p.events.CURRENT_USER);Object(a.useEffect)((function(){var e=p.getState(p.events.TOKEN);I.getAlbumsForCurrentUser(e).then((function(e){if(0!==e.code)p.fireEvent(p.events.DANGER_ALERT,"Unable to fetch albums");else{var t=e.response;r(t.map((function(e){return{albumId:e._id,albumName:e.name,isPrivate:e.isPrivate,userEmail:e.userEmail}})))}}))}),[]);var f=function(){if(b){var e=p.getState(p.events.TOKEN);I.getAlbumsForCurrentUser(e).then((function(e){if(0!==e.code)p.fireEvent(p.events.DANGER_ALERT,"Unable to fetch albums");else{var t=e.response;r(t.map((function(e){return{albumId:e._id,albumName:e.name,isPrivate:e.isPrivate,userEmail:e.userEmail}})))}}))}},v=function(e){j(e),l(1)};return Object(h.jsxs)(h.Fragment,{children:[0===i&&Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{className:"container",children:[Object(h.jsx)("div",{className:"row album-list",children:n.map((function(e){return Object(h.jsx)(M,{album:e,albumClickedHandler:v},e.albumId)}))}),Object(h.jsx)("div",{className:"row",children:Object(h.jsx)(B,{handler:f})})]})}),1===i&&Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{className:"container",children:[Object(h.jsx)("div",{className:"row",children:Object(h.jsx)(H,{title:"Edit Album",selectedAlbum:m,handler:function(){f(),l(0)}})}),Object(h.jsx)("div",{className:"row",children:Object(h.jsx)(q,{selectedAlbum:m})})]})})]})};var X=function(e){var t=e.userName,n=e.userEmail,r=e.userFollows,s=Object(a.useState)(p.getState(p.events.CURRENT_USER).userFollows),c=Object(o.a)(s,2),i=c[0],l=c[1];return Object(h.jsx)("div",{className:"card text-center shadow rounded post",children:Object(h.jsx)("div",{className:"card-body",children:Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("div",{className:"col-lg-3",children:Object(h.jsx)("img",{src:"/images/img_avatar.png",className:"img-fluid avatar",alt:"post pic"})}),Object(h.jsxs)("div",{className:"col-lg-3",children:[Object(h.jsx)("div",{children:t}),Object(h.jsx)("div",{children:n})]}),Object(h.jsx)("div",{className:"col-lg-3",children:Object(h.jsxs)("div",{children:["Follows: ",r.length]})}),Object(h.jsx)("div",{className:"col-lg-3",children:-1===i.findIndex((function(e){return e===n}))?Object(h.jsx)("button",{className:"btn btn-success btn-sm",onClick:function(e){var t=p.getState(p.events.TOKEN);I.followUser(n,t).then((function(e){if(0===e.code){var t=p.getState(p.events.CURRENT_USER);t.userFollows.push(n),l(t.userFollows),p.updateCurrentUser(t),p.fireEvent(p.events.SUCCESS_ALERT,"Followed a new user.")}else p.fireEvent(p.events.DANGER_ALERT,"Unable to follow user.")}))},children:"Follow"}):Object(h.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(e){var t=p.getState(p.events.TOKEN);I.unfollowUser(n,t).then((function(e){if(0===e.code){var t=p.getState(p.events.CURRENT_USER);t.userFollows=t.userFollows.filter((function(e){return e!==n})),l(t.userFollows),p.updateCurrentUser(t),p.fireEvent(p.events.SUCCESS_ALERT,"Unfollowed a new user.")}else p.fireEvent(p.events.DANGER_ALERT,"Unable to unfollow user.")}))},children:"Unfollow"})})]})})})};var Y=function(e){var t=e.searchedText,n=Object(a.useState)([]),r=Object(o.a)(n,2),s=r[0],c=r[1];return console.log(s),Object(a.useEffect)((function(){var e=p.getState(p.events.TOKEN);I.getSearchedUsers(t,e).then((function(e){if(0===e.code){var t=e.response;c(t)}else p.fireEvent(p.events.DANGER_ALERT,"Unable to fetch users.")}))}),[t]),Object(h.jsx)("div",{children:s.map((function(e,t){return Object(h.jsx)(X,{userName:e.userName,userEmail:e.userEmail,userFollows:e.userFollows},t)}))})};n(45);var z=function(){var e=Object(a.useState)(p.getState(p.events.CURRENT_USER)),t=Object(o.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(null),c=Object(o.a)(s,2),i=c[0],l=c[1],u=Object(a.useState)(null),d=Object(o.a)(u,2),m=d[0],j=d[1];function b(e){p.fireEvent(p.events.SUCCESS_ALERT,"Photo uploaded successflly."),l(null);var t=JSON.parse(e.currentTarget.response);t.photo&&j(I.getOriginURL()+"/userimage/"+t.photo)}function f(e){p.fireEvent(p.events.DANGER_ALERT,"Unable to upload photo."),console.log(e)}function v(e){p.fireEvent(p.events.DANGER_ALERT,"Unable to upload photo."),console.log(e)}return Object(a.useEffect)((function(){var e=p.getState(p.events.TOKEN),t=p.getState(p.events.CURRENT_USER);I.getUserDetails(t.userEmail,e).then((function(e){if(0===e.code){var n=e.response;n.photo&&j(I.getOriginURL()+"/userimage/"+n.photo),r(t)}else p.fireEvent(p.events.DANGER_ALERT,"Unable to get user details")}))}),[]),Object(h.jsxs)("div",{className:"card text-center shadow rounded post",children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("div",{className:"col-lg-6",children:Object(h.jsx)("img",{src:null==m?"/images/img_avatar.png":m,className:"img-fluid profile",alt:"post pic"})}),Object(h.jsxs)("div",{className:"col-lg-6",children:[Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("input",{type:"file",className:"form-control-file border",accept:"image/*",onChange:function(e){e.target.files[0]&&l(e.target.files[0])}})}),Object(h.jsx)("button",{className:"btn btn-success",onClick:function(e){!function(){var e=p.getState(p.events.TOKEN),t=I.getOriginURL();t+="/api/user/profile";var n=new FormData;n.append("userImage",i);var a=new XMLHttpRequest;a.addEventListener("load",b,!1),a.addEventListener("error",f,!1),a.addEventListener("abort",v,!1),a.open("POST",t),a.setRequestHeader("token","Bearer ".concat(e)),a.send(n)}()},children:"Change Photo"})]})]})}),Object(h.jsx)("div",{className:"card-body",children:n&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("p",{children:[Object(h.jsx)("b",{children:"User Name: "}),n.userName]}),Object(h.jsxs)("p",{children:[Object(h.jsx)("b",{children:"User Email: "}),n.userEmail]})]})}),Object(h.jsx)("div",{className:"card-footer myfooter"})]})};n(46);var Q=function(){var e=Object(a.useState)(""),t=Object(o.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(""),c=Object(o.a)(s,2),i=c[0],l=c[1],u=function(){var e=Object(S.a)(E.a.mark((function e(t){var a,r,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,I.doLogin(n,i);case 4:if(0===(a=e.sent).code){e.next=8;break}return p.fireEvent(p.events.DANGER_ALERT,"Unable to login"),e.abrupt("return");case 8:r=a.response,s={userName:r.userName,userEmail:r.userEmail,userFollows:r.follows},p.saveOrUpdateState(p.events.CURRENT_USER,s),localStorage.setItem(p.events.CURRENT_USER,JSON.stringify(s)),p.saveOrUpdateState(p.events.TOKEN,r.token),localStorage.setItem(p.events.TOKEN,r.token),p.fireEvent("login",null),p.fireEvent("home",null),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(1),console.log(e.t0),p.fireEvent(p.events.DANGER_ALERT,"Login Failed");case 22:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)("form",{className:"form myform container",onSubmit:u,children:[Object(h.jsx)("h2",{children:Object(h.jsx)("i",{children:"Login"})}),Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("input",{type:"email",className:"form-control",placeholder:"Enter email",value:n,onChange:function(e){r(e.target.value)},required:!0})}),Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter password",value:i,onChange:function(e){l(e.target.value)},required:!0})}),Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Login"})})]})};var V=function(){var e=Object(a.useState)(""),t=Object(o.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(""),c=Object(o.a)(s,2),i=c[0],l=c[1],u=Object(a.useState)(""),d=Object(o.a)(u,2),m=d[0],j=d[1],b=Object(f.e)();return Object(h.jsxs)("form",{className:"form myform container",onSubmit:function(e){e.preventDefault(),I.doRegister(n,m,i).then((function(e){0!==e.code?p.fireEvent(p.events.DANGER_ALERT,"Unable to create user."):b.push("/login")}))},children:[Object(h.jsx)("h2",{children:Object(h.jsx)("i",{children:"Sign up"})}),Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("input",{type:"text",className:"form-control",placeholder:"Enter username",value:m,onChange:function(e){j(e.target.value)},required:!0})}),Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("input",{type:"email",className:"form-control",placeholder:"Enter email",value:n,onChange:function(e){r(e.target.value)},required:!0})}),Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("input",{type:"password",className:"form-control",placeholder:"Enter password",value:i,onChange:function(e){l(e.target.value)},required:!0})}),Object(h.jsx)("div",{className:"form-group",children:Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Sign Up"})})]})};var Z=function(){var e=Object(a.useState)([]),t=Object(o.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)([]),c=Object(o.a)(s,2),i=c[0],l=c[1],u=Object(a.useState)(""),d=Object(o.a)(u,2),m=d[0],j=d[1],b=Object(a.useState)(""),v=Object(o.a)(b,2),g=v[0],N=v[1],x=Object(f.e)();p.registerHandler(p.events.SUCCESS_ALERT,(function(e){if(e){N(e);var t=document.getElementById("mySuccessAlert");t.classList.remove("alertMeShow"),t.offsetWidth,t.classList.add("alertMeShow")}})),p.registerHandler(p.events.DANGER_ALERT,(function(e){if(e){N(e);var t=document.getElementById("myDangerAlert");t.classList.remove("alertMeShow"),t.offsetWidth,t.classList.add("alertMeShow")}})),Object(a.useEffect)((function(){return p.registerHandler("login",(function(e){x.push("/"),function(){var e=p.getState(p.events.TOKEN);I.getWorldPosts(e).then((function(e){if(0===e.code){var t=e.response;r(t.map((function(e){return{album:e.album,dateAdded:e.dateAdded,postId:e._id,comments:e.comments,caption:e.caption,imageUrl:I.getOriginURL()+"/postimage/"+e.fileName,userEmail:e.userEmail,userName:e.userName}})))}else p.fireEvent(p.events.DANGER_ALERT,"Unable to fetch posts.")}))}()})),function(){p.removeHandler("login")}}),[x]),Object(a.useEffect)((function(){var e=p.getState(p.events.TOKEN);I.getWorldPosts(e).then((function(e){if(0===e.code){var t=e.response;r(t.map((function(e){return{album:e.album,dateAdded:e.dateAdded,postId:e._id,comments:e.comments,caption:e.caption,imageUrl:I.getOriginURL()+"/postimage/"+e.fileName,userEmail:e.userEmail,userName:e.userName}})))}else 21===e.code||22===e.code?p.fireEvent(p.events.DANGER_ALERT,"Please login or signup first."):p.fireEvent(p.events.DANGER_ALERT,"Unable to fetch posts.")}))}),[]);var E=function(e){l(e),x.push("/album")};return Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(O,{searchUserHandler:function(e){j(e),x.push("/searchUser")}}),Object(h.jsx)(f.a,{path:"/",exact:!0,render:function(e){return Object(h.jsx)("div",{className:"container",children:n.map((function(e){return Object(h.jsx)(K,{postId:e.postId,userName:e.userName,imageUrl:e.imageUrl,caption:e.caption,timestamp:e.dateAdded,album:e.album,openAlbum:E,comments:e.comments,userEmail:e.userEmail},e.postId)}))})}}),Object(h.jsx)(f.a,{path:"/upload",component:J}),Object(h.jsx)(f.a,{path:"/login",component:Q}),Object(h.jsx)(f.a,{path:"/signup",component:V}),Object(h.jsx)(f.a,{path:"/albums",render:function(e){return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(W,{})})}}),Object(h.jsx)(f.a,{path:"/album",exact:!0,render:function(e){return Object(h.jsx)("div",{className:"container",children:Object(h.jsx)(q,{selectedAlbum:i})})}}),Object(h.jsx)(f.a,{path:"/searchUser",exact:!0,render:function(e){return Object(h.jsx)("div",{className:"container",children:Object(h.jsx)(Y,{searchedText:m})})}}),Object(h.jsx)(f.a,{path:"/profile",exact:!0,render:function(e){return Object(h.jsx)("div",{className:"container",children:Object(h.jsx)(z,{})})}}),Object(h.jsxs)("div",{id:"mySuccessAlert",className:"alert alert-success alert-dismissible alertMe ",children:[Object(h.jsx)("strong",{children:"Success!"})," ",g]}),Object(h.jsxs)("div",{id:"myDangerAlert",className:"alert alert-danger alert-dismissible alertMe ",children:[Object(h.jsx)("strong",{children:"Failed!"})," ",g]})]})};c.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(v.a,{children:Object(h.jsx)(Z,{})})}),document.getElementById("root"))}},[[47,1,2]]]);
//# sourceMappingURL=main.65e8f161.chunk.js.map